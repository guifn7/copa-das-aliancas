<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Copa das Alian√ßas üíç</title>
<style>
  :root{--accent:#b63b6b;--bg:#faf9fb;--card:#fff;--muted:#666}
  body{font-family:Inter,system-ui,Arial;margin:0;background:var(--bg);color:#111}
  .wrap{max-width:980px;margin:26px auto;padding:20px}
  h1{margin:0 0 8px;font-size:28px}
  p.lead{margin:0 0 18px;color:var(--muted)}
  #setupGrid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
  .part{background:var(--card);padding:10px;border-radius:10px;box-shadow:0 6px 14px rgba(0,0,0,0.06);text-align:center}
  .part img{width:100%;height:110px;object-fit:cover;border-radius:8px;background:#f1f1f1}
  .pname{margin-top:8px;font-weight:600}
  .smallbtn{display:inline-block;margin-top:8px;padding:6px 10px;border-radius:8px;border:1px solid #eee;background:#fff;cursor:pointer;font-size:13px}
  #startBtn{margin-top:18px;padding:12px 18px;border-radius:10px;background:var(--accent);color:#fff;border:0;cursor:pointer;font-weight:700}
  #matchArea{display:none;margin-top:18px}
  .roundTitle{font-size:20px;margin-bottom:8px}
  .matchWrap{display:flex;gap:16px;align-items:center;justify-content:center;margin-top:10px}
  .card{width:42%;background:var(--card);padding:12px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.06);cursor:pointer;transition:transform .12s}
  .card:hover{transform:translateY(-6px)}
  .card img{width:100%;height:230px;object-fit:cover;border-radius:8px;background:#f6f6f6}
  .card .name{margin-top:10px;font-weight:700;text-align:center}
  .vs{font-size:18px;color:var(--muted);font-weight:700}
  .counter{margin-top:8px;color:var(--muted)}
  .finalBox{margin-top:18px;text-align:center}
  .champ{display:inline-block;padding:10px;border-radius:12px;background:#fff;box-shadow:0 10px 26px rgba(0,0,0,0.08);width:60%}
  .champ img{width:100%;height:220px;object-fit:cover;border-radius:8px}
  .btn{margin-top:12px;padding:10px 14px;border-radius:8px;border:0;cursor:pointer}
  .btn.secondary{background:#fff;border:1px solid #ddd}
  footer{margin-top:26px;color:#777;font-size:13px;text-align:center}
  @media (max-width:720px){
    #setupGrid{grid-template-columns:repeat(2,1fr)}
    .card img{height:160px}
  }
</style>
</head>
<body>
<div class="wrap">
  <h1>Copa das Alian√ßas üíç</h1>
  <p class="lead">Clique em <strong>Iniciar Torneio</strong> e escolha a cada partida a alian√ßa vencedora. Eu te amo minha Pequena <3</p>

  <div id="setup">
    <div id="setupGrid"></div>
    <button id="startBtn">Iniciar Torneio</button>
    <p style="margin-top:10px;color:var(--muted);font-size:13px"Voc√™ ainda vai casar comigo.</p>
  </div>

  <div id="matchArea">
    <div class="roundTitle" id="roundTitle">Oitavas de Final</div>
    <div class="counter" id="matchCounter">Partida 1 de 8</div>
    <div class="matchWrap">
      <div class="card" id="leftCard" data-side="L">
        <img id="leftImg" src="" alt="esquerda">
        <div class="name" id="leftName">Alian√ßa A</div>
      </div>

      <div class="vs">VS</div>

      <div class="card" id="rightCard" data-side="R">
        <img id="rightImg" src="" alt="direita">
        <div class="name" id="rightName">Alian√ßa B</div>
      </div>
    </div>

    <div class="finalBox" id="finalBox" style="display:none;">
      <div class="champ" id="championCard">
        <img id="champImg" src="">
        <div class="name" id="champName" style="margin-top:10px;font-size:18px"></div>
      </div>
      <div>
        <button class="btn" id="restartBtn" style="background:var(--accent);color:#fff">Reiniciar</button>
        <button class="btn secondary" id="editAgainBtn">Voltar e editar participantes</button>
      </div>
    </div>
  </div>

  <footer>Voc√™ √© o amor da minha vida</footer>
</div>

<script>
/* Dados iniciais */
const participants = Array.from({length:16}, (_,i)=>({
  id:i+1,
  name: `Alian√ßa ${i+1}`,
  img: null // data URL
}));

/* Helpers DOM */
const setupGrid = document.getElementById('setupGrid');
const startBtn = document.getElementById('startBtn');
const setupSection = document.getElementById('setup');
const matchArea = document.getElementById('matchArea');
const roundTitle = document.getElementById('roundTitle');
const matchCounter = document.getElementById('matchCounter');
const leftCard = document.getElementById('leftCard');
const rightCard = document.getElementById('rightCard');
const leftImg = document.getElementById('leftImg');
const rightImg = document.getElementById('rightImg');
const leftName = document.getElementById('leftName');
const rightName = document.getElementById('rightName');
const finalBox = document.getElementById('finalBox');
const champImg = document.getElementById('champImg');
const champName = document.getElementById('champName');
const restartBtn = document.getElementById('restartBtn');
const editAgainBtn = document.getElementById('editAgainBtn');

let currentRoundParticipants = []; // copia por rodada
let roundIndex = 0; // 0: oitavas, 1: quartas, 2: semi, 3: final
let matchIndex = 0;
let winners = [];

const roundLabels = ['Oitavas de Final','Quartas de Final','Semifinal','Final'];

function dataURLPlaceholder(text){
  // cria um SVG como placeholder e retorna dataURL
  const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='600' height='420'>
    <rect width='100%' height='100%' fill='#f6f6f8'/>
    <text x='50%' y='50%' font-size='28' fill='#999' dominant-baseline='middle' text-anchor='middle' font-family='Arial'>${text}</text>
  </svg>`;
  return 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svg);
}

/* Monta a grade de participantes para edi√ß√£o */
function renderSetup(){
  setupGrid.innerHTML='';
  participants.forEach((p, idx) => {
    const div = document.createElement('div');
    div.className='part';
    const img = document.createElement('img');
    img.src = p.img || dataURLPlaceholder(p.name);
    img.alt = p.name;
    img.setAttribute('data-idx', idx);

    const name = document.createElement('div');
    name.className='pname';
    name.innerText = p.name;
    name.contentEditable = true;
    name.style.outline = 'none';
    name.addEventListener('input', e=>{
      participants[idx].name = e.target.innerText.trim() || `Alian√ßa ${idx+1}`;
      img.src = participants[idx].img || dataURLPlaceholder(participants[idx].name);
    });

    const upload = document.createElement('button');
    upload.className='smallbtn';
    upload.innerText='Escolher imagem';
    const file = document.createElement('input');
    file.type='file';
    file.accept='image/*';
    file.style.display='none';
    file.addEventListener('change', ev=>{
      const f = ev.target.files[0];
      if(!f) return;
      const reader = new FileReader();
      reader.onload = function(evt){
        participants[idx].img = evt.target.result;
        img.src = participants[idx].img;
      }
      reader.readAsDataURL(f);
    });
    upload.addEventListener('click', ()=>file.click());

    div.appendChild(img);
    div.appendChild(name);
    div.appendChild(upload);
    div.appendChild(file);
    setupGrid.appendChild(div);
  });
}

/* Inicia torneio: copia participantes e come√ßa a primeira rodada */
function startTournament(){
  // valida
  if(participants.length !== 16){
    alert('Precisamos de 16 participantes.');
    return;
  }
  // lock edi√ß√£o
  setupSection.style.display='none';
  matchArea.style.display='block';
  finalBox.style.display='none';
  currentRoundParticipants = participants.map(p=>({...p})); // c√≥pia
  roundIndex = 0;
  startRound();
}

function startRound(){
  winners = [];
  matchIndex = 0;
  renderMatch();
}

function renderMatch(){
  const roundSize = currentRoundParticipants.length;
  const matches = roundSize / 2;
  roundTitle.innerText = roundLabels[roundIndex] || `Rodada ${roundIndex+1}`;
  matchCounter.innerText = `Partida ${matchIndex+1} de ${matches}`;

  const left = currentRoundParticipants[matchIndex*2];
  const right = currentRoundParticipants[matchIndex*2 + 1];

  leftImg.src = left.img || dataURLPlaceholder(left.name);
  rightImg.src = right.img || dataURLPlaceholder(right.name);
  leftName.innerText = left.name;
  rightName.innerText = right.name;

  // scroll to top of matchArea (mobile UX)
  window.scrollTo({top:matchArea.offsetTop-10, behavior:'smooth'});
}

/* Ao escolher vencedor */
function chooseWinner(which){
  const left = currentRoundParticipants[matchIndex*2];
  const right = currentRoundParticipants[matchIndex*2 + 1];
  const winner = (which==='L')? left : right;
  winners.push(winner);

  // pr√≥ximo match
  matchIndex++;
  const matches = currentRoundParticipants.length / 2;
  if(matchIndex < matches){
    renderMatch();
    return;
  }

  // rodada finalizada
  if(winners.length === 1){
    // caso extremo (somente 2 participantes na rodada) ‚Äî campe√£
    showChampion(winners[0]);
    return;
  }

  // se depois de uma rodada sobrar apenas 1 ganhador -> campe√£o
  if(winners.length === 1){
    showChampion(winners[0]);
    return;
  }

  // sen√£o, avan√ßa para a pr√≥xima rodada
  currentRoundParticipants = winners.map(w=>({...w}));
  roundIndex++;
  // se s√≥ sobrar 1 (ap√≥s final), show champion
  if(currentRoundParticipants.length === 1){
    showChampion(currentRoundParticipants[0]);
    return;
  }
  // iniciar pr√≥xima rodada com reset de matchIndex/winners
  startRound();
}

/* Mostra a campe√£ */
function showChampion(ch){
  finalBox.style.display='block';
  champImg.src = ch.img || dataURLPlaceholder(ch.name);
  champName.innerText = ch.name + " ‚Äî Campe√£ üèÜ";
  // esconder area de partidas
  roundTitle.innerText = 'Campe√£';
  matchCounter.innerText = '';
  leftCard.style.display='none';
  rightCard.style.display='none';
  document.querySelector('.vs').style.display='none';
}

/* Reiniciar para jogar de novo com mesma configura√ß√£o */
function restart(){
  // mostra cards novamente
  leftCard.style.display='block';
  rightCard.style.display='block';
  document.querySelector('.vs').style.display='block';
  finalBox.style.display='none';
  currentRoundParticipants = participants.map(p=>({...p}));
  roundIndex = 0;
  startRound();
}

/* Voltar para edi√ß√£o */
function editAgain(){
  // mostrar edi√ß√£o
  setupSection.style.display='block';
  matchArea.style.display='none';
  leftCard.style.display='block';
  rightCard.style.display='block';
  document.querySelector('.vs').style.display='block';
}

/* Eventos */
leftCard.addEventListener('click', ()=>chooseWinner('L'));
rightCard.addEventListener('click', ()=>chooseWinner('R'));
startBtn.addEventListener('click', startTournament);
restartBtn.addEventListener('click', restart);
editAgainBtn.addEventListener('click', editAgain);

/* Inicializa UI */
renderSetup();
</script>
</body>
</html>
